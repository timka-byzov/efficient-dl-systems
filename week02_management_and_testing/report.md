# Отчет

## Изменения
1) В ```unet``` модели вектор эмбедингов temb расширен и правильно бродкастится.
2) В ```diffusion``` модели к возвращаемым значениям добавлена ```x_t```; исправлена бага в формуле ```x_t```
3) Добавил ```poetry```
3) Отрефакторил функции в ```main.py``` для удобного парсинга ```hydra```-конфига.

## Запуск

Можно запускать базово через ```python main.py```. 

Можно добавлять аргументы: ```python train.py trainer.batch_size=64 trainer.num_epochs=50 trainer.peak_lr=1e-3 trainer.flip_augment=true```


## Тесты

1) Зафксировал сид для проверки лосса в тесте ```test_diffusion``` это позволяет сохранять верным предположение о правильно имплементированной модели и добавляет вомпроивзодимость.

2) Собрал пайплайн (интеграционный тест) для проверки модулей из training. Прогнал на случайном шуме, чтобы проверить работоспрособность. Параметризовал гиперпараметры модейлей и возможные девайсы.

## wandb

проект с ранами и артефактами: https://wandb.ai/byz0vtm-ural-federal-university/effdl?nw=nwuserbyz0vtm

run на 100 эпох: https://wandb.ai/byz0vtm-ural-federal-university/effdl/runs/mkpngma8?nw=nwuserbyz0vtm
